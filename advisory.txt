Advisory ID: FAB-2019-00157
Product: Live Input Macros
Manufacturer: Old Street Solutions
Affected Version(s): 2.10 and before
Tested Version(s): 2.10
Vulnerability Type: Cross-Site Scripting (CWE-79)
Risk Level: High
CVSS v3.0: 7.6
Vektor String: CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:L/A:H
Vendor Homepage: https://www.oldstreetsolutions.com/
Software Link:
https://marketplace.atlassian.com/apps/1215287/live-input-macros
Solution Status: Reported
Manufacturer Notification: 2019-08-19
CVE Reference: CVE-2019-15233
Author of Advisory: Francesco Emanuel Bennici, FABMation GmbH


Description
===========

Live Input Macros gives Users the possibility to add checkboxes, radio
buttons,
dropdown lists and more to your Confluence pages and make changes without
editing the page.

An attacker can execute JavaScript Code on the Confluence Site if a User
adds the malicous Code.

This can be used to steal the Session Cookie of an (eg.) Administrator
(Session
Hijacking).

Found by Francesco Emanuel Bennici of FABMation GmbH.


Proof of Concept (PoC)
======================

Create a new Macro ('+' -> Other Macros -> 'Live:Text Box'). Enter a random
Unique ID and set the "Content Format" to "HTML".
Now enter this Text in the Text Box field:
```html
Hello World this is my Text Box </p> </div>





alksdfjlkasdjflkj </p> " <br/> <style/onload=alert(1)> <br/> " <p> asdasd





This ends not with TAG!! 
```

The JS Script Code from `<style/onload=alert(1)>` will be executed on
Page Load.


Solution
========

Search for Text with the following Regex: <.*(\/?).*>
And replace all the selected Text with ''.

Disclosure Timeline
===================

**NEEDS TO BE UPDATED**

2019-08-19: Vulnerability discovered
2019-08-19: Vulnerability reported to manufacturer

Credits
=======

This security vulnerability was found by Francesco Emanuel Bennici of
FABMation GmbH.

E-Mail: eb@fabmation.de
Public Key:
https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x17FA2D56BAD01661
Key ID: 0x17FA2D56BAD01661
Key Fingerprint: B643 49C6 B652 CD12 C03F  DACD 17FA 2D56 BAD0 1661


Copyright
=========

Creative Commons - Attribution (by) - Version 3.0
URL: https://creativecommons.org/licenses/by/3.0/deed.en
